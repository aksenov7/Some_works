# Scraping_sites_for_feeds
Scraping dynamic feeds form sites
Проект для сбора динамических списков доменов с различных сайтов.
Парсит списки доменов, нормализует их и кладет в виде файл.csv на https://forest1.getaura.ru/feeds/denis-feeds/
Если вы хотите добавить новый сайт, то необходимо:
1) Зайти в терминал. Перейти в папку, где вы работаете с репозиториями git.
    Скопировать репозиторий:
    ```
    git clone git@github.com:safedns/Scraping_sites_for_feeds.git
    ```
2) Затем в удобном для вас режиме перейдите в папку "malware_list", где лежат файлы проекта.
3) Если вы планируете использовать каие-то новые библиотеки, которых нет в проекте, то необходимо прописать их установку в       Dockerfile. Изменения внести следующей строкой после:
    ```
    RUN pip install bs4 \
        tldextract==2.2.0 \
        pandas==0.23.4 \
        lxml==4.3.2 ```
4) Основную работу делает файл "malware_scraper.py", но его изменения потребуются только в случае, если произошло что-то не предвиденное логикой парсера. В идеале для добавления задачи на парсинг нового сайта достаточно изменить файл "schemes.py"
5) Переходим в "schemes.py". В самом низу вы увидете '''INSTRUCTION TO CREATE SCHEMES''', в которой описана структура написания схемы, которая будет автоматически считываться.
    Но если кратко, то:
        - "base_schemeN" - будет содержать ссылку на ваш сайт и имя, с которым вы хотите сохранить файл со списком доменов.
        - "child_schemeN" - будет содержать путь к контейнеру, в котором лежит искомый список.
        - "text_schemeN" - содержит информацию о том, как нужно обрабатывать полученный из контейнера текс, чтобы он принял каноничный вид списка доменов.
6) В конце не забудьте добавить ваши схемы в:
    ```
    SCHEME = [[base_scheme1, child_scheme1, text_scheme1],
         [base_scheme2, child_scheme2, text_scheme2],
         [base_scheme3, child_scheme3, text_scheme3],
         [ваши схемы]
       ]```
7) Теперь перейдите в терминале в папку "Scraping_sites_for_feeds/malware_list/" и выполниете команды
    ```
       docker-compose build
       docker-compose push```
       
Теперь образ перестроен и залит на кластер, где спокойно работает.

8) Осталось отправить ваши изменения обратно на git и попросить коллег поревьюить.
